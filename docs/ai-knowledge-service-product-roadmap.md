# AI çŸ¥è¯†æœåŠ¡ ETL - äº§å“è·¯çº¿å›¾

> æœ¬æ–‡æ¡£å®šä¹‰ AI çŸ¥è¯†æœåŠ¡ ETL å±‚çš„äº§å“è·¯çº¿å›¾ï¼Œä»åŸºç¡€æ¡†æ¶åˆ°ç”Ÿäº§åŒ–éƒ¨ç½²çš„å…¨é˜¶æ®µè§„åˆ’ã€‚

---

## ä¸€ã€ETL æœåŠ¡æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            ETL æœåŠ¡æ¶æ„                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         ç”¨æˆ·å±‚ (User Layer)                          â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚   â”‚  â”‚         ç®¡ç†æ§åˆ¶å° (Admin)      â”‚  â”‚        CLI å·¥å…·            â”‚   â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         API å±‚ (API Layer)                           â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚   â”‚  â”‚ çŸ¥è¯†åº“ API  â”‚  â”‚  ç‰ˆæœ¬ API   â”‚  â”‚  ä»»åŠ¡ API   â”‚  â”‚ WebSocket  â”‚  â”‚   â”‚
â”‚   â”‚  â”‚ /kb        â”‚  â”‚ /versions   â”‚  â”‚ /tasks      â”‚  â”‚  /ws       â”‚  â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                       æœåŠ¡å±‚ (Service Layer)                         â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚   â”‚  â”‚    Ingestion    â”‚  â”‚    Indexing     â”‚  â”‚    Publishing       â”‚  â”‚   â”‚
â”‚   â”‚  â”‚   (æ•°æ®é‡‡é›†)     â”‚  â”‚   (ç´¢å¼•æ„å»º)     â”‚  â”‚    (å‘å¸ƒéƒ¨ç½²)        â”‚  â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                       æŠ½è±¡å±‚ (Abstraction Layer)                     â”‚   â”‚
â”‚   â”‚                           æ¥å£å®šä¹‰ã€é¢†åŸŸæ¨¡å‹                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     åŸºç¡€è®¾æ–½å±‚ (Infrastructure)                       â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚   â”‚  â”‚ Qdrant â”‚ â”‚ SQLite â”‚ â”‚ Redis  â”‚ â”‚  LLM   â”‚ â”‚Embeddingâ”‚ â”‚  FS    â”‚ â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€é˜¶æ®µè§„åˆ’

### Phase 1: åŸºç¡€æ¡†æ¶

**ç›®æ ‡**: è®©æŠ½è±¡å±‚å¯è¿è¡Œï¼Œå»ºç«‹å¼€å‘åŸºç¡€

**çŠ¶æ€**: ğŸ”„ è¿›è¡Œä¸­

| ä»»åŠ¡ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| æŠ½è±¡å±‚è®¾è®¡æ–‡æ¡£ | å®Œæ•´çš„æ¥å£è®¾è®¡æ–‡æ¡£ | âœ… å®Œæˆ |
| æŠ½è±¡å±‚ä»£ç  | æ‰€æœ‰æ¥å£å®šä¹‰ | âœ… å®Œæˆ |
| DI å®¹å™¨å®ç° | ç®€å•ä¾èµ–æ³¨å…¥å®¹å™¨ | â³ å¾…å¼€å§‹ |
| å†…å­˜é˜Ÿåˆ—å®ç° | å¼€å‘ç”¨ä»»åŠ¡é˜Ÿåˆ— | â³ å¾…å¼€å§‹ |
| æ—¥å¿—å®ç° | æ§åˆ¶å°æ—¥å¿—è¾“å‡º | â³ å¾…å¼€å§‹ |
| æ–‡ä»¶å­˜å‚¨å®ç° | æ–‡ä»¶ç³»ç»Ÿ + SQLite | â³ å¾…å¼€å§‹ |
| ç‰ˆæœ¬ç®¡ç†å™¨å®ç° | SQLite ç‰ˆæœ¬ç®¡ç† | â³ å¾…å¼€å§‹ |

**äº§å‡ºç‰©**:
```
implementations/
â”œâ”€â”€ infrastructure/
â”‚   â”œâ”€â”€ simple_container.py          # DI å®¹å™¨
â”‚   â”œâ”€â”€ memory_queue.py              # å†…å­˜ä»»åŠ¡é˜Ÿåˆ—
â”‚   â”œâ”€â”€ memory_event_bus.py          # å†…å­˜äº‹ä»¶æ€»çº¿
â”‚   â””â”€â”€ sqlite_version_manager.py    # ç‰ˆæœ¬ç®¡ç†å™¨
â”œâ”€â”€ observability/
â”‚   â”œâ”€â”€ console_logger.py            # æ§åˆ¶å°æ—¥å¿—
â”‚   â”œâ”€â”€ noop_metrics.py              # ç©ºæ“ä½œ metrics
â”‚   â””â”€â”€ noop_tracer.py               # ç©ºæ“ä½œ tracer
â””â”€â”€ storage/
    â”œâ”€â”€ filesystem_content_store.py  # æ–‡ä»¶å†…å®¹å­˜å‚¨
    â”œâ”€â”€ sqlite_metadata_store.py     # SQLite å…ƒæ•°æ®
    â””â”€â”€ composite_raw_file_storage.py # ç»„åˆå­˜å‚¨
```

---

### Phase 2: æ ¸å¿ƒç®¡é“

**ç›®æ ‡**: ETL ç®¡é“å¯ç«¯åˆ°ç«¯è¿è¡Œ

**çŠ¶æ€**: â³ å¾…å¼€å§‹

| ä»»åŠ¡ | è¯´æ˜ |
|------|------|
| ä»»åŠ¡è°ƒåº¦å™¨ | çº¿ç¨‹æ± è°ƒåº¦å™¨ï¼Œæ”¯æŒå¹¶å‘æ‰§è¡Œ |
| Ingestion æ‰§è¡Œå™¨ | æ•°æ®é‡‡é›†ç®¡é“æ‰§è¡Œå™¨ |
| Indexing æ‰§è¡Œå™¨ | ç´¢å¼•æ„å»ºç®¡é“æ‰§è¡Œå™¨ |
| Publishing æ‰§è¡Œå™¨ | å‘å¸ƒç®¡é“æ‰§è¡Œå™¨ |
| Source Connectors | Sitemapã€Forum APIã€æ–‡ä»¶ç³»ç»Ÿè¿æ¥å™¨ |
| å¤„ç†æ­¥éª¤ | Parserã€Chunkerã€Enricherã€Embedder |
| Qdrant å­˜å‚¨ | å‘é‡ç´¢å¼•å­˜å‚¨å®ç° |

**äº§å‡ºç‰©**:
```
core/
â”œâ”€â”€ scheduler/
â”‚   â””â”€â”€ thread_scheduler.py          # çº¿ç¨‹æ± è°ƒåº¦å™¨
â””â”€â”€ executors/
    â”œâ”€â”€ base_executor.py             # åŸºç±»
    â”œâ”€â”€ ingestion_executor.py        # é‡‡é›†æ‰§è¡Œå™¨
    â”œâ”€â”€ indexing_executor.py         # ç´¢å¼•æ‰§è¡Œå™¨
    â””â”€â”€ publishing_executor.py       # å‘å¸ƒæ‰§è¡Œå™¨

implementations/
â”œâ”€â”€ connectors/
â”‚   â”œâ”€â”€ sitemap_connector.py         # Sitemap è¿æ¥å™¨
â”‚   â”œâ”€â”€ forum_api_connector.py       # è®ºå› API è¿æ¥å™¨
â”‚   â””â”€â”€ filesystem_connector.py      # æ–‡ä»¶ç³»ç»Ÿè¿æ¥å™¨
â”œâ”€â”€ steps/
â”‚   â”œâ”€â”€ parsers/
â”‚   â”‚   â”œâ”€â”€ html_parser.py           # HTML è§£æå™¨
â”‚   â”‚   â””â”€â”€ markdown_parser.py       # Markdown è§£æå™¨
â”‚   â”œâ”€â”€ chunkers/
â”‚   â”‚   â””â”€â”€ sentence_chunker.py      # å¥å­åˆ†ç‰‡å™¨
â”‚   â”œâ”€â”€ enrichers/
â”‚   â”‚   â”œâ”€â”€ qa_enricher.py           # QA ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ summary_enricher.py      # æ‘˜è¦ç”Ÿæˆ
â”‚   â””â”€â”€ embedders/
â”‚       â””â”€â”€ dashscope_embedder.py    # DashScope åµŒå…¥
â””â”€â”€ storage/
    â””â”€â”€ qdrant_index_storage.py      # Qdrant å­˜å‚¨
```

---

### Phase 3: ç®¡ç† API

**ç›®æ ‡**: é€šè¿‡ API ç®¡ç†çŸ¥è¯†åº“å’Œä»»åŠ¡

**çŠ¶æ€**: â³ å¾…å¼€å§‹

**API ç«¯ç‚¹è®¾è®¡**:

```
/api/

# çŸ¥è¯†åº“ç®¡ç†
GET    /knowledge-bases                    # åˆ—å‡ºçŸ¥è¯†åº“
POST   /knowledge-bases                    # åˆ›å»ºçŸ¥è¯†åº“
GET    /knowledge-bases/{id}               # è·å–è¯¦æƒ…
PUT    /knowledge-bases/{id}               # æ›´æ–°çŸ¥è¯†åº“
DELETE /knowledge-bases/{id}               # åˆ é™¤çŸ¥è¯†åº“

# ç‰ˆæœ¬ç®¡ç†
GET    /knowledge-bases/{id}/versions      # åˆ—å‡ºç‰ˆæœ¬
POST   /knowledge-bases/{id}/versions      # åˆ›å»ºç‰ˆæœ¬
GET    /versions/{id}                      # ç‰ˆæœ¬è¯¦æƒ…
PUT    /versions/{id}                      # æ›´æ–°ç‰ˆæœ¬
DELETE /versions/{id}                      # åˆ é™¤ç‰ˆæœ¬

# æ„å»ºä¸å‘å¸ƒ
POST   /versions/{id}/build                # è§¦å‘æ„å»º
POST   /versions/{id}/publish              # è§¦å‘å‘å¸ƒ
GET    /versions/{id}/files                # æ–‡ä»¶åˆ—è¡¨

# ä»»åŠ¡ç®¡ç†
GET    /tasks                              # ä»»åŠ¡åˆ—è¡¨
GET    /tasks/{id}                         # ä»»åŠ¡è¯¦æƒ…
GET    /tasks/{id}/logs                    # ä»»åŠ¡æ—¥å¿—
POST   /tasks/{id}/cancel                  # å–æ¶ˆä»»åŠ¡
POST   /tasks/{id}/retry                   # é‡è¯•ä»»åŠ¡

# æ•°æ®æº
GET    /connectors                         # å¯ç”¨è¿æ¥å™¨ç±»å‹
POST   /connectors/test                    # æµ‹è¯•è¿æ¥

# ç¯å¢ƒç®¡ç†
GET    /environments                       # ç›®æ ‡ç¯å¢ƒåˆ—è¡¨
POST   /environments                       # æ·»åŠ ç¯å¢ƒ
DELETE /environments/{id}                  # åˆ é™¤ç¯å¢ƒ

# ç³»ç»Ÿ
GET    /health                             # å¥åº·æ£€æŸ¥
GET    /metrics                            # æŒ‡æ ‡æ•°æ®
GET    /config                             # ç³»ç»Ÿé…ç½®
```

**äº§å‡ºç‰©**:
```
api/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ main.py                              # FastAPI åº”ç”¨å…¥å£
â”œâ”€â”€ dependencies.py                      # ä¾èµ–æ³¨å…¥é…ç½®
â”œâ”€â”€ routers/
â”‚   â”œâ”€â”€ knowledge_bases.py               # çŸ¥è¯†åº“è·¯ç”±
â”‚   â”œâ”€â”€ versions.py                      # ç‰ˆæœ¬è·¯ç”±
â”‚   â”œâ”€â”€ tasks.py                         # ä»»åŠ¡è·¯ç”±
â”‚   â”œâ”€â”€ connectors.py                    # è¿æ¥å™¨è·¯ç”±
â”‚   â”œâ”€â”€ environments.py                  # ç¯å¢ƒè·¯ç”±
â”‚   â””â”€â”€ system.py                        # ç³»ç»Ÿè·¯ç”±
â”œâ”€â”€ schemas/
â”‚   â”œâ”€â”€ knowledge_base.py                # è¯·æ±‚/å“åº”æ¨¡å‹
â”‚   â”œâ”€â”€ version.py
â”‚   â”œâ”€â”€ task.py
â”‚   â””â”€â”€ common.py
â””â”€â”€ middleware/
    â”œâ”€â”€ error_handler.py                 # é”™è¯¯å¤„ç†
    â””â”€â”€ logging.py                       # è¯·æ±‚æ—¥å¿—
```

---

### Phase 4: ç®¡ç†æ§åˆ¶å° (Admin UI)

**ç›®æ ‡**: å¯è§†åŒ–ç®¡ç†çŸ¥è¯†åº“æ„å»ºæµç¨‹

**çŠ¶æ€**: â³ å¾…å¼€å§‹

**åŠŸèƒ½æ¨¡å—**:

```
ç®¡ç†æ§åˆ¶å°
â”œâ”€â”€ ä»ªè¡¨ç›˜ (Dashboard)
â”‚   â”œâ”€â”€ çŸ¥è¯†åº“æ€»è§ˆå¡ç‰‡
â”‚   â”œâ”€â”€ ä»»åŠ¡çŠ¶æ€ç»Ÿè®¡
â”‚   â”œâ”€â”€ æœ€è¿‘æ´»åŠ¨æ—¶é—´çº¿
â”‚   â””â”€â”€ ç³»ç»Ÿå¥åº·çŠ¶æ€
â”‚
â”œâ”€â”€ çŸ¥è¯†åº“ç®¡ç† (Knowledge Bases)
â”‚   â”œâ”€â”€ çŸ¥è¯†åº“åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ æœç´¢/ç­›é€‰
â”‚   â”‚   â”œâ”€â”€ çŠ¶æ€æ ‡ç­¾
â”‚   â”‚   â””â”€â”€ å¿«æ·æ“ä½œ
â”‚   â”œâ”€â”€ åˆ›å»ºçŸ¥è¯†åº“å‘å¯¼
â”‚   â”‚   â”œâ”€â”€ åŸºæœ¬ä¿¡æ¯
â”‚   â”‚   â”œâ”€â”€ æ•°æ®æºé…ç½®
â”‚   â”‚   â”œâ”€â”€ å¤„ç†ç®¡é“é…ç½®
â”‚   â”‚   â””â”€â”€ å‘å¸ƒç›®æ ‡é…ç½®
â”‚   â”œâ”€â”€ çŸ¥è¯†åº“è¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ æ¦‚è§ˆä¿¡æ¯
â”‚   â”‚   â”œâ”€â”€ ç‰ˆæœ¬å†å²
â”‚   â”‚   â”œâ”€â”€ æ–‡ä»¶æµè§ˆå™¨
â”‚   â”‚   â””â”€â”€ é…ç½®ç¼–è¾‘
â”‚   â””â”€â”€ ç‰ˆæœ¬ç®¡ç†
â”‚       â”œâ”€â”€ ç‰ˆæœ¬å¯¹æ¯”
â”‚       â”œâ”€â”€ æ„å»ºè§¦å‘
â”‚       â””â”€â”€ å‘å¸ƒç®¡ç†
â”‚
â”œâ”€â”€ ä»»åŠ¡ä¸­å¿ƒ (Tasks)
â”‚   â”œâ”€â”€ ä»»åŠ¡åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ çŠ¶æ€ç­›é€‰
â”‚   â”‚   â”œâ”€â”€ ç±»å‹ç­›é€‰
â”‚   â”‚   â””â”€â”€ æ—¶é—´èŒƒå›´
â”‚   â”œâ”€â”€ ä»»åŠ¡è¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ æ‰§è¡Œè¿›åº¦
â”‚   â”‚   â”œâ”€â”€ æ­¥éª¤ç»Ÿè®¡
â”‚   â”‚   â”œâ”€â”€ é”™è¯¯åˆ—è¡¨
â”‚   â”‚   â””â”€â”€ å®æ—¶æ—¥å¿—
â”‚   â””â”€â”€ ä»»åŠ¡è°ƒåº¦
â”‚       â”œâ”€â”€ å®šæ—¶ä»»åŠ¡é…ç½®
â”‚       â””â”€â”€ æ‰‹åŠ¨è§¦å‘
â”‚
â”œâ”€â”€ æ•°æ®æºç®¡ç† (Sources)
â”‚   â”œâ”€â”€ è¿æ¥å™¨ç±»å‹åˆ—è¡¨
â”‚   â”œâ”€â”€ è¿æ¥æµ‹è¯•å·¥å…·
â”‚   â””â”€â”€ é‡‡é›†å†å²è®°å½•
â”‚
â”œâ”€â”€ å‘å¸ƒç®¡ç† (Publishing)
â”‚   â”œâ”€â”€ ç›®æ ‡ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ å‘å¸ƒå†å²
â”‚   â”œâ”€â”€ åˆ«åç®¡ç†
â”‚   â””â”€â”€ å›æ»šæ“ä½œ
â”‚
â””â”€â”€ ç³»ç»Ÿè®¾ç½® (Settings)
    â”œâ”€â”€ å¤„ç†æ­¥éª¤é…ç½®
    â”‚   â”œâ”€â”€ åˆ†ç‰‡å‚æ•°
    â”‚   â”œâ”€â”€ QA ç”Ÿæˆå‚æ•°
    â”‚   â””â”€â”€ åµŒå…¥å‚æ•°
    â”œâ”€â”€ LLM é…ç½®
    â”‚   â”œâ”€â”€ API å¯†é’¥
    â”‚   â”œâ”€â”€ æ¨¡å‹é€‰æ‹©
    â”‚   â””â”€â”€ é€Ÿç‡é™åˆ¶
    â”œâ”€â”€ å­˜å‚¨é…ç½®
    â”‚   â”œâ”€â”€ æ–‡ä»¶å­˜å‚¨è·¯å¾„
    â”‚   â””â”€â”€ æ•°æ®åº“è¿æ¥
    â””â”€â”€ ç³»ç»Ÿä¿¡æ¯
        â”œâ”€â”€ ç‰ˆæœ¬ä¿¡æ¯
        â””â”€â”€ è®¸å¯è¯
```

**æŠ€æœ¯é€‰å‹**:
- æ¡†æ¶: React 18
- UI åº“: Ant Design 5.x
- çŠ¶æ€ç®¡ç†: React Query
- è·¯ç”±: React Router
- æ„å»º: Vite
- è¯­è¨€: TypeScript

**äº§å‡ºç‰©**:
```
admin-ui/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.tsx
â”‚   â”œâ”€â”€ main.tsx
â”‚   â”œâ”€â”€ api/                             # API å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ client.ts
â”‚   â”‚   â”œâ”€â”€ knowledge-bases.ts
â”‚   â”‚   â”œâ”€â”€ tasks.ts
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ components/                      # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Layout/
â”‚   â”‚   â”œâ”€â”€ DataTable/
â”‚   â”‚   â”œâ”€â”€ StatusBadge/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ pages/                           # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Dashboard/
â”‚   â”‚   â”œâ”€â”€ KnowledgeBases/
â”‚   â”‚   â”œâ”€â”€ Tasks/
â”‚   â”‚   â”œâ”€â”€ Settings/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ hooks/                           # è‡ªå®šä¹‰ Hooks
â”‚   â”œâ”€â”€ stores/                          # çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ utils/                           # å·¥å…·å‡½æ•°
â”œâ”€â”€ package.json
â””â”€â”€ vite.config.ts
```

---

### Phase 5: ç”Ÿäº§åŒ–

**ç›®æ ‡**: ç”Ÿäº§ç¯å¢ƒå°±ç»ª

**çŠ¶æ€**: â³ å¾…å¼€å§‹

| ä»»åŠ¡ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|------|------|--------|
| Redis é˜Ÿåˆ— | æ›¿æ¢å†…å­˜é˜Ÿåˆ—ï¼Œæ”¯æŒåˆ†å¸ƒå¼ | é«˜ |
| Prometheus Metrics | ç”Ÿäº§çº§ç›‘æ§æŒ‡æ ‡ | é«˜ |
| OpenTelemetry | åˆ†å¸ƒå¼è¿½è¸ªé›†æˆ | ä¸­ |
| ç»“æ„åŒ–æ—¥å¿— | JSON æ ¼å¼æ—¥å¿—è¾“å‡º | é«˜ |
| é…ç½®ç®¡ç† | å¤šç¯å¢ƒé…ç½®æ”¯æŒ | é«˜ |
| Docker é•œåƒ | å®¹å™¨åŒ–éƒ¨ç½² | é«˜ |
| Docker Compose | æœ¬åœ°/æµ‹è¯•ç¯å¢ƒç¼–æ’ | é«˜ |
| Kubernetes | ç”Ÿäº§é›†ç¾¤éƒ¨ç½² | ä¸­ |
| Helm Charts | K8s åŒ…ç®¡ç† | ä¸­ |
| CI/CD | GitHub Actions æµæ°´çº¿ | é«˜ |
| å¥åº·æ£€æŸ¥ | å°±ç»ª/å­˜æ´»æ¢é’ˆ | é«˜ |
| ä¼˜é›…å…³é—­ | ä¿¡å·å¤„ç†ã€è¿æ¥æ’ç©º | é«˜ |
| é™æµ | API é€Ÿç‡é™åˆ¶ | ä¸­ |
| è®¤è¯ | API Key / JWT | é«˜ |
| æˆæƒ | RBAC æƒé™æ§åˆ¶ | ä¸­ |
| å®¡è®¡æ—¥å¿— | æ“ä½œè®°å½• | ä¸­ |
| å¤‡ä»½æ¢å¤ | æ•°æ®å¤‡ä»½ç­–ç•¥ | ä¸­ |

**äº§å‡ºç‰©**:
```
deploy/
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ Dockerfile.etl
â”‚   â””â”€â”€ Dockerfile.admin
â”œâ”€â”€ docker-compose/
â”‚   â”œâ”€â”€ docker-compose.dev.yml
â”‚   â”œâ”€â”€ docker-compose.staging.yml
â”‚   â””â”€â”€ docker-compose.prod.yml
â”œâ”€â”€ kubernetes/
â”‚   â”œâ”€â”€ namespace.yaml
â”‚   â”œâ”€â”€ configmap.yaml
â”‚   â”œâ”€â”€ secret.yaml
â”‚   â”œâ”€â”€ deployment-etl.yaml
â”‚   â”œâ”€â”€ service.yaml
â”‚   â”œâ”€â”€ ingress.yaml
â”‚   â””â”€â”€ hpa.yaml
â”œâ”€â”€ helm/
â”‚   â””â”€â”€ ai-knowledge-etl/
â”‚       â”œâ”€â”€ Chart.yaml
â”‚       â”œâ”€â”€ values.yaml
â”‚       â””â”€â”€ templates/
â””â”€â”€ .github/
    â””â”€â”€ workflows/
        â”œâ”€â”€ ci.yml
        â”œâ”€â”€ build.yml
        â””â”€â”€ deploy.yml

implementations/
â”œâ”€â”€ infrastructure/
â”‚   â””â”€â”€ redis_queue.py                   # Redis ä»»åŠ¡é˜Ÿåˆ—
â””â”€â”€ observability/
    â”œâ”€â”€ prometheus_metrics.py            # Prometheus æŒ‡æ ‡
    â”œâ”€â”€ opentelemetry_tracer.py          # OTel è¿½è¸ª
    â””â”€â”€ structured_logger.py             # ç»“æ„åŒ–æ—¥å¿—
```

---

### Phase 6: é«˜çº§ç‰¹æ€§

**ç›®æ ‡**: å¢å¼ºåŠŸèƒ½å’Œæ‰©å±•èƒ½åŠ›

**çŠ¶æ€**: â³ é•¿æœŸè§„åˆ’

| ç‰¹æ€§ | è¯´æ˜ | å¤æ‚åº¦ |
|------|------|--------|
| å¤šç§Ÿæˆ· | ç§Ÿæˆ·éš”ç¦»ã€é…é¢ç®¡ç† | é«˜ |
| Webhook | äº‹ä»¶é€šçŸ¥é›†æˆ (æ„å»ºå®Œæˆã€å‘å¸ƒç­‰) | ä½ |
| æ’ä»¶ç³»ç»Ÿ | è‡ªå®šä¹‰å¤„ç†æ­¥éª¤ã€è¿æ¥å™¨ | é«˜ |
| Python SDK | ç¼–ç¨‹å¼ ETL æ¥å£ | ä¸­ |
| CLI å·¥å…· | å‘½ä»¤è¡Œç®¡ç†å·¥å…· | ä¸­ |
| å®šæ—¶è°ƒåº¦ | Cron å¼ä»»åŠ¡è°ƒåº¦ | ä¸­ |
| å¢é‡åŒæ­¥ | å®æ—¶/å‡†å®æ—¶æ•°æ®åŒæ­¥ | é«˜ |
| æ•°æ®è¡€ç¼˜ | æ–‡ä»¶å¤„ç†è¿½è¸ª | ä¸­ |
| è´¨é‡æ£€æµ‹ | ç´¢å¼•è´¨é‡è¯„ä¼° | ä¸­ |

---

## ä¸‰ã€æ—¶é—´çº¿æ€»è§ˆ

```
Phase 1: åŸºç¡€æ¡†æ¶        â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  å½“å‰é˜¶æ®µ
Phase 2: æ ¸å¿ƒç®¡é“        â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
Phase 3: ç®¡ç† API        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
Phase 4: ç®¡ç†æ§åˆ¶å°       â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
Phase 5: ç”Ÿäº§åŒ–          â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  (æŒç»­è¿›è¡Œ)
Phase 6: é«˜çº§ç‰¹æ€§        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  (é•¿æœŸè§„åˆ’)
```

---

## å››ã€ä¸ç°æœ‰ç³»ç»Ÿçš„å…³ç³»

### ä»£ç è¿ç§»æ˜ å°„

```
ç°æœ‰ç³»ç»Ÿ                              æ–°æ¶æ„
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

gc-qa-rag-etl/                    â†’   ETL æœåŠ¡
â”œâ”€â”€ etlapp/das/
â”‚   â”œâ”€â”€ das_doc.py                â†’   SitemapConnector
â”‚   â”œâ”€â”€ das_forum.py              â†’   ForumApiConnector
â”‚   â””â”€â”€ das_generic.py            â†’   FilesystemConnector
â”œâ”€â”€ etlapp/etl/
â”‚   â”œâ”€â”€ etl_doc/generate.py       â†’   QAEnricher
â”‚   â”œâ”€â”€ etl_doc/generate_sub.py   â†’   SynonymEnricher
â”‚   â””â”€â”€ etl_doc/generate_full.py  â†’   FullAnswerEnricher
â”œâ”€â”€ etlapp/common/
â”‚   â”œâ”€â”€ chunk.py                  â†’   SentenceChunker
â”‚   â”œâ”€â”€ embedding.py              â†’   DashScopeEmbedder
â”‚   â””â”€â”€ vector.py                 â†’   QdrantIndexStorage
â””â”€â”€ etlapp/ved/                   â†’   PublishingExecutor
```

### è¿ç§»ç­–ç•¥

1. **å¹¶è¡Œè¿è¡Œ**: æ–°æ—§ç³»ç»Ÿå¹¶è¡Œè¿è¡Œï¼Œé€æ­¥åˆ‡æ¢æµé‡
2. **é€‚é…å™¨æ¨¡å¼**: é€šè¿‡é€‚é…å™¨å°†ç°æœ‰ä»£ç æ¥å…¥æ–°æŠ½è±¡å±‚
3. **æ¸è¿›å¼è¿ç§»**: æŒ‰æ¨¡å—é€æ­¥è¿ç§»ï¼Œé™ä½é£é™©
4. **æ•°æ®å…¼å®¹**: ä¿æŒç´¢å¼•æ ¼å¼å…¼å®¹ï¼Œæ”¯æŒæ— ç¼åˆ‡æ¢

---

## äº”ã€æ–‡æ¡£ç‰ˆæœ¬

| ç‰ˆæœ¬ | æ—¥æœŸ | è¯´æ˜ |
|-----|------|------|
| 1.0 | 2026-01-17 | åˆç¨¿ |
| 1.1 | 2026-01-17 | èšç„¦ ETL å±‚ï¼Œç§»é™¤ RAG æŸ¥è¯¢æœåŠ¡ç›¸å…³å†…å®¹ |
